<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Reggae Surprise</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css?v=8" />
</head>
<body>

  <!-- Navigation -->
  <nav>
    <ul>
      <li><a href="#" onclick="showSection('accueil')" class="active">Accueil</a></li>
      <li><a href="#" onclick="showSection('rencontre')">Rencontre</a></li>
      <li><a href="#" onclick="showSection('videos')">Vidéos</a></li>
      <li><a href="#" onclick="showSection('concerts')">Concerts</a></li>
      <li><a href="#" onclick="showSection('souvenir')">Souvenir</a></li>
      <li><a href="#" onclick="showSection('contact')">Contact</a></li>
    </ul>
  </nav>

  <!-- Lecteur Audio -->
  <div class="audio-player" id="audioPlayer">
    <img src="logo-reggae-surprise.png" alt="Logo Reggae Surprise" id="logo" draggable="false" />
    <div id="playButtonOverlay">▶</div>
  </div>
  <audio id="audioElement"></audio>

  <main>
    <!-- ACCUEIL -->
    <section id="accueil" class="active">
      <div class="overlay-content">
        <div class="container">
          <img src="accueil.jpg" alt="Photo Accueil" class="photo-accueil" draggable="false" />
        </div>
      </div>
    </section>

    <!-- Galerie 1 (1 photo) -->
    <div class="between-gallery one">
      <img src="gal1.jpg" alt="" loading="lazy">
    </div>

    <!-- RENCONTRE -->
    <section id="rencontre">
      <div class="overlay-content">
        <div class="container">
          <p class="rencontre-text">
            Une histoire de passionnés… Avant la surprise, il y a eu une rencontre.
            Cinq musiciens aux univers différents, réunis par l'amour du groove et du reggae.
          </p>
          <div class="carousel">
            <div class="carousel-content">
              <button class="carousel-btn left" onclick="prevMember()">&#10094;</button>
              <img id="member-photo" src="Julie.jpeg" alt="Membre" draggable="false" />
              <button class="carousel-btn right" onclick="nextMember()">&#10095;</button>
            </div>
            <p id="member-text" class="member-text"></p>
          </div>
        </div>
      </div>
    </section>

    <!-- Galerie 2 (2 photos) -->
    <div class="between-gallery two">
      <img src="gal2.jpg" alt="" loading="lazy">
      <img src="gal3.jpg" alt="" loading="lazy">
    </div>

    <!-- VIDEOS -->
    <section id="videos">
      <div class="overlay-content">
        <div class="container">
          <h2 class="section-title">Vidéos</h2>
          <div class="video-grid">
            <div class="video-embed"><iframe src="https://www.youtube.com/embed/zKMnLi_MgBU" allowfullscreen></iframe></div>
            <div class="video-embed"><iframe src="https://www.youtube.com/embed/lnlzKieaveo" allowfullscreen></iframe></div>
            <div class="video-embed"><iframe src="https://www.youtube.com/embed/fmNJjPm3r4M" allowfullscreen></iframe></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Galerie 3 (1 photo) -->
    <div class="between-gallery one">
      <img src="gal4.jpg" alt="" loading="lazy">
    </div>

    <!-- CONCERTS -->
    <section id="concerts">
      <div class="overlay-content">
        <div class="container">
          <h2 class="section-title">Concerts</h2>
          <img src="programme-concerts.jpg" alt="Programme des concerts" class="concert-img" draggable="false" />
        </div>
      </div>
    </section>

    <!-- Galerie 4 (2 photos) -->
    <div class="between-gallery two">
      <img src="gal5.jpg" alt="" loading="lazy">
      <img src="gal6.jpg" alt="" loading="lazy">
    </div>

    <!-- SOUVENIR -->
    <section id="souvenir">
      <div class="overlay-content">
        <div class="container">
          <p class="souvenir-text">Viens nous voir sur place… et repars avec un objet unique.</p>
          <img class="merch-img" src="merch.jpg" alt="Aperçu merchandising" loading="lazy">
        </div>
      </div>
    </section>

    <!-- Galerie 5 (1 photo) -->
    <div class="between-gallery one">
      <img src="gal7.jpg" alt="" loading="lazy">
    </div>

    <!-- CONTACT -->
    <section id="contact">
      <div class="overlay-content">
        <div class="container">
          <h2 class="section-title">Contact</h2>
          <form id="contactForm" action="https://formspree.io/f/mldlkrov" method="POST" novalidate>
            <label for="name">Nom :</label>
            <input type="text" id="name" name="name" required />
            <label for="email">Email :</label>
            <input type="email" id="email" name="_replyto" required />
            <label for="message">Message :</label>
            <textarea id="message" name="message" rows="6" required></textarea>
            <button type="submit" id="sendBtn">Envoyer</button>
            <p id="formStatus" class="form-status"></p>
          </form>
        </div>
      </div>
    </section>
  </main>

  <script>
    // --- Navigation
    const sections = document.querySelectorAll('section');
    const navLinks = document.querySelectorAll('nav a');
    function showSection(id) {
      sections.forEach(sec => sec.classList.remove('active'));
      navLinks.forEach(a => a.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('nav a').forEach(a => {
        if (a.getAttribute('onclick') === `showSection('${id}')`) a.classList.add('active');
      });
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // --- Audio
    const audioFiles = []; for (let i=1;i<=20;i++) audioFiles.push(`audio${i}.mp3`);
    let currentTrack = 0;
    const audio = document.getElementById('audioElement');
    const logo = document.getElementById('logo');
    const playOverlay = document.getElementById('playButtonOverlay');
    let isPlaying = false, firstPlay = true, clickTimeout;

    function playTrack(index){
      audio.src = audioFiles[index];
      audio.play().catch(()=>{});
      isPlaying = true;
      logo.classList.remove('blink');
      logo.classList.add('playing');
      playOverlay.style.display='none';
    }
    function pauseTrack(){
      audio.pause();
      isPlaying = false;
      logo.classList.remove('playing');
      logo.classList.add('blink');
      playOverlay.style.display='block';
    }
    document.getElementById('audioPlayer').addEventListener('click', () => {
      if (clickTimeout){
        clearTimeout(clickTimeout);
        clickTimeout=null;
        currentTrack=(currentTrack+1)%audioFiles.length;
        playTrack(currentTrack);
        return;
      }
      clickTimeout=setTimeout(()=>{
        if(!isPlaying){
          if(firstPlay){
            playTrack(currentTrack);
            firstPlay=false;
          } else {
            audio.play().then(()=>{
              isPlaying=true;
              logo.classList.remove('blink');
              logo.classList.add('playing');
              playOverlay.style.display='none';
            }).catch(()=>{});
          }
        } else {
          pauseTrack();
        }
        clickTimeout=null;
      }, 250);
    });
    audio.addEventListener('ended', ()=>{
      currentTrack=(currentTrack+1)%audioFiles.length;
      playTrack(currentTrack);
    });
    logo.classList.add('blink');
    playOverlay.style.display='block';

    // --- Carrousel avec animation mot par mot (une seule fois)
    const members = [/* mêmes objets texte que précédemment */];
    let currentMember = 0;
    const photoEl = document.getElementById('member-photo');
    const textEl = document.getElementById('member-text');
    const seenMembers = new Set();

    function typeWriter(text, callback) {
      let words = text.split(" ");
      let i = 0;
      textEl.textContent = "";
      function nextWord() {
        if (i < words.length) {
          textEl.textContent += (i === 0 ? "" : " ") + words[i];
          i++;
          setTimeout(nextWord, 80);
        } else if (callback) callback();
      }
      nextWord();
    }
    function updateMember() {
      const member = members[currentMember];
      photoEl.src = member.photo;
      if (seenMembers.has(currentMember)) {
        textEl.textContent = member.text;
      } else {
        typeWriter(member.text, () => seenMembers.add(currentMember));
      }
    }
    function prevMember(){ currentMember=(currentMember-1+members.length)%members.length; updateMember(); }
    function nextMember(){ currentMember=(currentMember+1)%members.length; updateMember(); }
    updateMember();
  </script>
</body>
</html>
